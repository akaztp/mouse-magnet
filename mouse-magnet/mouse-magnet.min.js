function MouseMagnet(n){"use strict";function e(){var n=this;s(n._physics,n.config.particleSelector,n.elemsPhysics,n.config.attraction,n._mouseParticle);n._physics.onUpdate(function(){h.apply(n,null)});n._physics.play();$("body").mousemove(n,i);$(n.config.boundsSelector).mouseenter(n,r);$(n.config.boundsSelector).mouseleave(n,u);$(window).resize(function(){f.apply(n,null)})}function o(){var n=this;n._physics.toggle();n.elemsPhysics.forEach(function(n){n.elem.css("left","0");n.elem.css("top","0")})}function s(n,t,i,r,u){$(t).each(function(t,f){var e={elem:$(f)};e.pos=e.elem.offset();e.dim={width:e.elem.width(),height:e.elem.height()};e.middlePos={left:e.pos.left+e.dim.width/2,top:e.pos.top+e.dim.height/2};e.dolly=n.makeParticle(1,e.middlePos.left,e.middlePos.top);e.anchor=n.makeParticle(1,e.middlePos.left,e.middlePos.top);e.anchor.makeFixed();e.attraction=n.makeSpring(e.anchor,e.dolly,.5,.5,0);e.repulsion=n.makeAttraction(e.dolly,u,(r?1:-1)*5e4,20);e.repulsion.on=!1;i.push(e)})}function i(n){var t={top:n.pageY,left:n.pageX};n.data._mouseParticle.position.x=t.left;n.data._mouseParticle.position.y=t.top}function r(n){n.data.elemsPhysics.forEach(function(n){n.repulsion.on=!0});n.data._inited=!1}function u(n){n.data.elemsPhysics.forEach(function(n){n.repulsion.on=!1});n.data._inited=!1}function h(){var n=this,t;n.config.lowCpuDetect&&(t=(new Date).getTime(),n._lowCpuData.lastRenderTime||(n._lowCpuData.lastRenderTime=t),t-n._lowCpuData.lastRenderTime>100?n._lowCpuData.detectedCycles++>5&&(n._lowCpuData.detectedCycles=0,n.toggle(),n.config.lowCpuCallback&&n.config.lowCpuCallback()):n._lowCpuData.detectedCycles=0);n.elemsPhysics.forEach(function(n){var t={left:n.dolly.position.x-n.dim.width/2,top:n.dolly.position.y-n.dim.height/2};n.elem.offset(t)});n._lowCpuData.lastRenderTime=t}function f(){var n=this;n.elemsPhysics.forEach(function(n){var t={left:n.dolly.position.x-n.middlePos.left,top:n.dolly.position.y-n.middlePos.top};n.elem.css("left","0").css("top","0");n.pos=n.elem.offset();n.dim={width:n.elem.width(),height:n.elem.height()};n.middlePos={left:n.pos.left+n.dim.width/2,top:n.pos.top+n.dim.height/2};n.dolly.position.x=n.middlePos.left+t.left;n.dolly.position.y=n.middlePos.top+t.top;n.anchor.position.x=n.middlePos.left;n.anchor.position.y=n.middlePos.top;n.anchor.makeFixed()})}function c(n){if(n._inited){var e=$(n.config.particleSelector),f=l(e),t={data:n};r(t);t.pageX=f.left+e.width()/2;t.pageY=f.top+e.height()/2;i(t);window.setTimeout(function(){t.data._inited&&(t.pageX=f.left-1,t.pageY=f.top-1,i(t),u(t),t.data._inited=!0)},200);n._inited=!0}else window.clearInterval(n._pokeInterval)}function l(n){var t=n.offset(),i;return n.each(function(n,r){i=$(r).offset();t.top=(t.top+i.top)/2;t.left=(t.left+i.left)/2}),t}var t=this;t.config=n;t.elemsPhysics=[];typeof t.start!="function"&&(MouseMagnet.prototype.start=e,MouseMagnet.prototype.toggle=o,MouseMagnet.prototype.reposition=f);t._lowCpuData={lastRenderTime:null,detectedCycles:0};t._inited=!0;t._physics=new Physics(0,t.config.drag);t._mouseParticle=t._physics.makeParticle(1,0,0);t._mouseParticle.makeFixed();t._pokeInterval=null;t.config.autoPoke&&(t.pokeInterval=window.setInterval(c,t.config.autoPoke*1e3,t))}